{% extends 'base.html' %}

{% block title %}Крепкий Фундамент{% endblock %}

{% block page_style %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/index/main_index.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
{% endblock %}
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<!-- SECTIONS -->
{% block sections %}
<style>
.hero-section {
    background:
        /* Градиент-туман */
        /* linear-gradient(to right, rgba(255,255,255,0.65) 0%, rgba(255,255,255,0.0) 50%),
        url('{{ url_for("static", filename=projects[0].images.first().url) }}'); */
        linear-gradient(to right, rgba(255,255,255,0.5) 40%, 
        rgba(255,255,255,0) 60%), url('/static/uploads/bergen-60/1.webp');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed; /* только для десктопа */
    min-height: 100vh;
    padding: 180px 0 120px;
    color: white;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
}


/* На мобильных отключаем fixed */
@media (max-width: 768px) {
    .hero-section {
        background-attachment: scroll;
    }
}

</style>
    <section id="home" class="hero-section">
        <div class="container">
            <div class="row align-items-center min-vh-100">
                <div class="col-lg-8" data-aos="fade-up" data-aos-duration="1000">
                    <div class="hero-content">
                        <!-- Бейдж -->
                        <div class="hero-badge" data-aos="fade-up" data-aos-delay="200">
                            <i class="bi bi-award-fill"></i>
                            Строим с 2010 года
                        </div>
                        <!-- Заголовок -->
                        <h1 class="hero-title">
                            Строим современные<br>
                            <span class="hero-highlight">энергоэффективные</span><br>
                            дома под ключ
                        </h1>
                        <!-- Технология -->
                        <div class="technology-badge" data-aos="fade-up" data-aos-delay="300">
                            <i class="bi bi-lightning-charge"></i>
                            Технология: СИП-панели
                        </div>
                        <!-- Подзаголовок -->
                        <p class="hero-subtitle">
                            Премиум-качество <span class="text-accent">без переплаты</span></p>
                        <!-- Геолокации -->
                        <div class="hero-locations" data-aos="fade-up" data-aos-delay="300">
                            <div class="location-item">
                                <i class="bi bi-geo-alt-fill"></i>
                                <span>Стерлитамак</span>
                            </div>
                            <div class="location-item">
                                <i class="bi bi-geo-alt-fill"></i>
                                <span>Салават</span>
                            </div>
                            <div class="location-item">
                                <i class="bi bi-geo-alt-fill"></i>
                                <span>Ишимбай</span>
                            </div>
                            <div class="location-item">
                                <i class="bi bi-geo-alt-fill"></i>
                                <span>Кумертау</span>
                            </div>
                            <div class="location-item">
                                <i class="bi bi-geo-alt-fill"></i>
                                <span>Северо-Восток</span>
                            </div>
                            <div class="location-item">
                                <i class="bi bi-geo-alt-fill"></i>
                                <span>Булгаково</span>
                            </div>
                        </div>
                        <!-- Кнопки -->
                        <div class="hero-actions" data-aos="fade-up" data-aos-delay="300">
                            <a href="#contact" class="btn btn-primary-custom">
                            <i class="bi bi-house-check me-2"></i>
                            Получить консультацию
                            </a>
                            <a href="#projects" class="btn btn-outline-custom">
                            <i class="bi bi-images me-2"></i>
                            Смотреть проекты
                            </a>
                        </div>
                        
                        <!-- Преимущества -->
                        <div class="hero-features" data-aos="fade-up" data-aos-delay="300">
                            <div class="feature-item">
                                <i class="bi bi-clock-fill"></i>
                                <span>3 месяца</span>
                            </div>
                            <div class="feature-item">
                                <i class="bi bi-shield-check"></i>
                                <span>Гарантия 10 лет</span>
                            </div>
                            <div class="feature-item">
                                <i class="bi bi-safe-fill"></i>
                                <span>Ипотека через эскроу</span>
                            </div>
                            <div class="feature-item">
                                <i class="bi bi-building-check"></i>
                                <span>Строительный надзор</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FEATURES -->
    <section id="features" class="features-section">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up">Почему выбирают нас</h2>
            <div class="row g-4">
                <!-- Карточка 1: Готовый дом -->
                <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="100">
                    <div class="info-card">
                        <div class="card-icon"><i class="bi bi-house-check-fill"></i></div>
                        <h3>Дом — полностью готов к жизни</h3>
                        <p>Всё, что нужно для комфортного переезда — уже включено. Полная отделка и готовая инженерия.</p>
                        <ul class="feature-list mt-3">
                            <li><i class="bi bi-check-circle-fill"></i> Стены под поклейку обоев</li>
                            <li><i class="bi bi-check-circle-fill"></i> Межкомнатные двери и натяжные потолки</li>
                            <li><i class="bi bi-check-circle-fill"></i> Тёплые полы в ключевых зонах</li>
                            <li><i class="bi bi-check-circle-fill"></i> Чистовая отделка и санузел</li>
                            <li><i class="bi bi-check-circle-fill"></i> Ламинат, плитка, сантехника</li>
                            <li><i class="bi bi-check-circle-fill"></i> Электрика: щиток, розетки, выключатели</li>
                            <li><i class="bi bi-check-circle-fill"></i> Вода, отопление, канализация</li>
                            <li><i class="bi bi-check-circle-fill"></i> Архитектурная подсветка и ниши</li>
                        </ul>
                        <p class="mt-3 fw-semibold">Вы получаете дом, в который можно заехать в день получения ключей.</p>
                    </div>
                </div>
                <!-- Карточка 2: Ипотека -->
                <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="200">
                    <div class="info-card">
                        <div class="card-icon"><i class="bi bi-bank2"></i></div>
                        <h3>Ипотека и полное сопровождение</h3>
                        <p>Мы оформим льготную ипотеку на весь комплекс: дом, забор, баню, гараж и даже мебель — одной выгодной ставкой.</p>
                        <p>Работаем с ведущими банками и полностью ведём процесс: от покупки участка до ввода дома в эксплуатацию и постановки на учёт.</p>
                        <p class="fw-semibold mt-3">Принцип “единого окна”: все вопросы — у нас, результат — у вас.</p>
                    </div>
                </div>
                <!-- Карточка 3: Проекты -->
                <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="300">
                    <div class="info-card">
                        <div class="card-icon"><i class="bi bi-pencil-square"></i></div>
                        <h3>Проекты, созданные профессионалами</h3>
                        <p>Все дома разрабатываются опытными архитекторами и дизайнерами, поэтому выглядят современно и продуманно:</p>
                        <ul class="feature-list mt-3">
                            <li><i class="bi bi-check-circle-fill"></i> Без лишних квадратов, только полезные площади</li>
                            <li><i class="bi bi-check-circle-fill"></i> Удобные планировки</li>
                            <li><i class="bi bi-check-circle-fill"></i> Панорамная раздвижная дверь на террасу 2,3 м по стандарту</li>
                            <li><i class="bi bi-check-circle-fill"></i> Индивидуальный проект — если не нашли подходящий среди готовых</li>
                        </ul>
                    </div>
                </div>
                <!-- Карточка 4: Надёжность -->
                <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="400">
                    <div class="info-card">
                        <div class="card-icon"><i class="bi bi-shield-check"></i></div>
                        <h3>Надёжность и энергоэффективность</h3>
                        <p>Мы строим дома по энергоэффективным технологиям, что обеспечивает тепло и минимальные затраты на отопление.</p>
                        <p>Используем проверенные материалы и собственные стандарты строительства — ваш дом надолго сохранит внешний вид и комфорт.</p>
                    </div>
                </div>
                <!-- Карточка 5: О компании -->
                <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="500">
                    <div class="info-card">
                        <div class="card-icon"><i class="bi bi-building"></i></div>
                        <h3>О компании</h3>
                        <p>«Крепкий Фундамент» — строительная компания, специализирующаяся на домах под ключ.</p>
                        <p>Мы делаем процесс максимально простым и понятным, а результат — качественным и долговечным.</p>
                    </div>
                </div>
                <!-- Карточка 6: Сроки -->
                <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="600">
                    <div class="info-card">
                        <div class="card-icon"><i class="bi bi-lightning-charge"></i></div>
                        <h3>Быстрые сроки</h3>
                        <p>Всего <strong>3 месяца</strong> — от договора до переезда в готовый дом.</p>
                        <p>Мы ценим ваше время и соблюдаем все оговоренные сроки строительства.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- PROJECTS -->
<section id="projects" class="projects-section">
    <div class="container">
        <h2 class="section-title" data-aos="fade-up">Наши проекты</h2>
        <div class="row">
            {% for project in projects %}
            <div class="col-md-6 col-lg-4 mb-4" data-aos="fade-up" data-aos-delay="">
                <div class="project-card">
                    <!-- IMAGES CAROUSEL -->
                    <div class="project-carousel">
                        <div id="carousel{{ project.id }}" class="carousel slide touch-carousel">
                            <div class="carousel-indicators">
                                {% for image in project.images.all() %}
                                <button type="button" data-bs-target="#carousel{{ project.id }}" 
                                    data-bs-slide-to="{{ loop.index0 }}" 
                                    class="{% if loop.first %}active{% endif %}" 
                                    aria-label="Slide {{ loop.index }}"></button>
                                {% endfor %}
                            </div>
                            <div class="carousel-inner">
                                {% for image in project.images.all() %}
                                <div class="carousel-item {% if loop.first %}active{% endif %}">
                                    <img src="{{ url_for('static', filename=image.url) }}" 
                                        class="d-block w-100" 
                                        alt="{{ project.title }}">
                                </div>
                                {% endfor %}
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carousel{{ project.id }}" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carousel{{ project.id }}" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                    </div>
                    <!-- PROJECT PRICES -->
                    <div class="project-info">
                        <h4 class="project-title">{{ project.title }}</h4>
                        <div class="project-meta">
                            <div class="project-sizes">
                                <i class="bi bi-aspect-ratio"></i>
                                {{ project.square }} м²
                            </div>
                            <div class="project-sizes">
                                <i class="bi bi-arrows-fullscreen"></i>
                                {{ project.size }} м
                            </div>
                        </div>
                        <div class="card-price-section">
                            <div class="price-tier">
                                <span class="price-label">Базовая отделка</span>
                                <span class="price-value">{{ "{:,}".format(project.price_base).replace(",", " ") }} ₽</span>
                            </div>
                            {% if project.price_with_communications %}
                            <div class="price-tier">
                                <span class="price-label">С коммуникациями</span>
                                <span class="price-value">{{ "{:,}".format(project.price_with_communications).replace(",", " ") }} ₽</span>
                            </div>
                            {% endif %}
                            {% if project.price_ready %}
                            <div class="price-tier highlight">
                                <span class="price-label">Под ключ</span>
                                <span class="price-value">{{ "{:,}".format(project.price_ready).replace(",", " ") }} ₽</span>
                            </div>
                            {% endif %}
                        </div>
                        {% if project.mortgage_price_per_month %}
                        <div class="mortgage-section">
                            <i class="bi bi-house-check"></i>
                            Ипотека от&nbsp;<strong>{{ "{:,}".format(project.mortgage_price_per_month).replace(",", " ") }} ₽/мес</strong>
                        </div>
                        {% endif %}
                        <a href="{{ url_for('main.details', slug=project.slug) }}" class="btn-project-details">
                            Подробнее о проекте
                            <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<style>
    /* Добавляем стили для улучшенного свайпа на мобильных */
    @media (max-width: 768px) {
        .touch-carousel {
            touch-action: pan-y;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .touch-carousel .carousel-item {
            transition: transform 0.3s ease;
        }
        
        /* Увеличиваем область клика для индикаторов */
        .carousel-indicators button {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin: 0 4px;
        }
        
        /* Увеличиваем область клика для кнопок навигации */
        .carousel-control-prev,
        .carousel-control-next {
            width: 50px;
            height: 50px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.2);
            border-radius: 50%;
        }
        
        .carousel-control-prev {
            left: 10px;
        }
        
        .carousel-control-next {
            right: 10px;
        }
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Функция для добавления свайпа к каруселям
    function addSwipeToCarousels() {
        const carousels = document.querySelectorAll('.touch-carousel');
        
        carousels.forEach(carousel => {
            let touchStartX = 0;
            let touchEndX = 0;
            const minSwipeDistance = 50; // минимальное расстояние свайпа в пикселях
            
            // Получаем индикаторы и элементы карусели
            const indicators = carousel.querySelectorAll('.carousel-indicators button');
            const items = carousel.querySelectorAll('.carousel-item');
            const prevBtn = carousel.querySelector('.carousel-control-prev');
            const nextBtn = carousel.querySelector('.carousel-control-next');
            
            // Добавляем обработчики touch событий
            carousel.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });
            
            carousel.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, { passive: true });
            
            // Обработка свайпа
            function handleSwipe() {
                const swipeDistance = touchEndX - touchStartX;
                
                // Если свайп достаточно длинный
                if (Math.abs(swipeDistance) > minSwipeDistance) {
                    if (swipeDistance > 0) {
                        // Свайп вправо - предыдущий слайд
                        triggerPrevSlide();
                    } else {
                        // Свайп влево - следующий слайд
                        triggerNextSlide();
                    }
                }
            }
            
            // Функции для переключения слайдов
            function triggerPrevSlide() {
                if (prevBtn) {
                    prevBtn.click();
                } else {
                    // Альтернативный способ через Bootstrap API
                    const bsCarousel = bootstrap.Carousel.getInstance(carousel);
                    if (bsCarousel) {
                        bsCarousel.prev();
                    }
                }
            }
            
            function triggerNextSlide() {
                if (nextBtn) {
                    nextBtn.click();
                } else {
                    // Альтернативный способ через Bootstrap API
                    const bsCarousel = bootstrap.Carousel.getInstance(carousel);
                    if (bsCarousel) {
                        bsCarousel.next();
                    }
                }
            }
            
            // Добавляем обработчики клика на индикаторы для лучшей мобильной поддержки
            indicators.forEach(indicator => {
                indicator.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    this.click();
                }, { passive: false });
            });
            
            // Добавляем обработчики для кнопок навигации
            if (prevBtn) {
                prevBtn.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    this.click();
                }, { passive: false });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    this.click();
                }, { passive: false });
            }
        });
    }
    
    // Инициализируем свайп после загрузки DOM
    addSwipeToCarousels();
    
    // Переинициализируем свайп при изменении ориентации экрана
    window.addEventListener('orientationchange', function() {
        setTimeout(addSwipeToCarousels, 100);
    });
});
</script>


{% endblock %}


{% block page_script %}

{% endblock %}

