{% extends "base.html" %}

{% block title %}–î–æ–º "–°–æ–ª–Ω–µ—á–Ω—ã–π" - –ö—Ä–µ–ø–∫–∏–π –§—É–Ω–¥–∞–º–µ–Ω—Ç{% endblock %}

{% block hero %}{% endblock %}
{% block features %} {% endblock %}

{% block content %}
{% block styles %} 
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename = '/css/style_details.css') }}">
{% endblock %}

<!-- üîπ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ -->
<section class="py-5">
  <div class="container">
    <div class="row g-4 align-items-start">

      <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç -->
      <div class="col-lg-6">
        
        <h1 class="fw-normal mb-3 d-flex align-items-center"
    style="font-family: 'Oswald', sans-serif; color: #4a4a4a; letter-spacing: 0.5px;">

  {{ project.title }}
  <span class="text-secondary mx-2">‚Ä¢</span>
  <small class="fw-normal text-secondary"> 
    <i class="bi bi-aspect-ratio"></i> {{ project.square }} –º¬≤ 
  </small>
</h1>

        <p class="text-secondary fs-6 mb-4">
          {{ project.description }}
        </p>
    
      </div>

    <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
      <div class="col-lg-4">
        <div class="card border-0 shadow-sm p-4 rounded-4">
          <!-- <h5 class="fw-bold mb-3" style="font-family: 'Oswald', sans-serif;">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h5> -->

          <div class="table-responsive">
            <table class="table table-borderless align-middle mb-0 beautiful-table">
              <tbody>
                <tr>
                  <th><i class="bi me-2 bi-aspect-ratio"></i>–ü–ª–æ—â–∞–¥—å</th>

                  <td>{{ project.square }} m¬≤</td>
                </tr>
                <tr>
                  <th><i class="bi me-2 bi-arrows-angle-expand"></i>–ì–∞–±–∞—Ä–∏—Ç—ã</th>

                  <td>{{ project.size }} m</td>
                </tr>
                <tr>
                  <th><i class="bi bi-cash-stack me-2 text-success"></i>–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞</th>
                  <td>{{ project.price_base | money }} ‚ÇΩ</td>
                </tr>
                <tr>
                  <th><i class="bi bi-lightning-charge me-2 text-warning"></i>–° –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º–∏</th>
                  <td>{{ project.price_with_communications | money }} ‚ÇΩ</td>
                </tr>
                <tr>
                  <th><i class="bi bi-house-door me-2 text-info"></i>–¶–µ–Ω–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –¥–æ–º–∞</th>
                  <td>{{ project.price_ready | money }} ‚ÇΩ</td>
                </tr>
                <tr>
                  <th><i class="bi bi-credit-card me-2 text-primary"></i>–ò–ø–æ—Ç–µ–∫–∞ / –º–µ—Å—è—Ü</th>
                  <td>{{ project.mortgage_price_per_month | money }} ‚ÇΩ</td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>
      </div>
    </div>
  
  </div>
</section>

<!-- üîπ –ì–∞–ª–µ—Ä–µ—è –ø—Ä–æ–µ–∫—Ç–∞ -->
<section class="py-5 bg-light">
  <div class="container">
    <div class="card border-0 shadow p-3">
      <div class="text-center mb-3">
        <img id="mainImage" src="{{ url_for('static', filename=project.images.first().url) }}"
             class="gallery-main img-fluid" alt="–ì–ª–∞–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
      </div>

      <div class="gallery-thumbs">
        {% for image in project.images.all() %}
        <img src="{{ url_for('static', filename=image.url) }}" class="gallery-thumb" onclick="changeImage(this)">
        {% endfor %}
        <!-- <img src="../static/houses_images/house_1/1.webp" class="gallery-thumb active" onclick="changeImage(this)">
        <img src="../static/houses_images/house_1/2.webp" class="gallery-thumb" onclick="changeImage(this)"> -->
        
      </div>
    </div>
  </div>


  <!-- –ú–æ–¥–∞–ª–∫–∞ —Å –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º -->
  <div class="modal fade" id="fullscreenModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-fullscreen">
      <div class="modal-content bg-dark border-0">
        <div class="modal-body p-0">
  <button class="nav-btn left" id="prevBtn" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ">
    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="15 18 9 12 15 6" />
    </svg>
  </button>

  <img id="fullscreenImage" src="" class="img-fluid rounded" alt="–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">

  <button class="nav-btn right" id="nextBtn" aria-label="–°–ª–µ–¥—É—é—â–µ–µ">
    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="9 18 15 12 9 6" />
    </svg>
  </button>

  <button type="button" class="btn btn-light position-absolute top-0 end-0 m-3"
          data-bs-dismiss="modal">‚úï</button>
</div>

      </div>
    </div>
  </div>

 

  <script>
    let currentIndex = 0;
    const thumbs = document.querySelectorAll('.gallery-thumb');
    const mainImage = document.getElementById('mainImage');
    const fullscreenImage = document.getElementById('fullscreenImage');
    const modalEl = document.getElementById('fullscreenModal');

    function changeImage(el) {
      const main = document.getElementById('mainImage');
      main.style.opacity = 0;
      setTimeout(() => {
        main.src = el.src;
        main.style.opacity = 1;
      }, 200);
      thumbs.forEach(img => img.classList.remove('active'));
      el.classList.add('active');
      currentIndex = Array.from(thumbs).indexOf(el);
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏
    mainImage.addEventListener('click', () => {
      fullscreenImage.src = mainImage.src;
      const modal = new bootstrap.Modal(modalEl);
      modal.show();
    });

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    prevBtn.addEventListener('click', showPrev);
    nextBtn.addEventListener('click', showNext);

    function fadeChange(newSrc) {
      fullscreenImage.style.opacity = 0;
      setTimeout(() => {
        fullscreenImage.src = newSrc;
        fullscreenImage.style.opacity = 1;
      }, 200);
    }

    function showPrev() {
      currentIndex = (currentIndex - 1 + thumbs.length) % thumbs.length;
      fadeChange(thumbs[currentIndex].src);
    }

    function showNext() {
      currentIndex = (currentIndex + 1) % thumbs.length;
      fadeChange(thumbs[currentIndex].src);
    }

    // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç—Ä–µ–ª–æ–∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    document.addEventListener('keydown', (e) => {
      if (modalEl.classList.contains('show')) {
        if (e.key === 'ArrowLeft') showPrev();
        if (e.key === 'ArrowRight') showNext();
      }
    });
  </script>

  <script>
  // --- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–∞–π–ø–æ–≤ –Ω–∞ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö ---
  let touchStartX = 0;
  let touchEndX = 0;

  const swipeZone = document.getElementById('fullscreenImage');

  swipeZone.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
  });

  swipeZone.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
  });

  function handleSwipe() {
    const swipeDistance = touchEndX - touchStartX;
    if (Math.abs(swipeDistance) < 50) return; // —Ñ–∏–ª—å—Ç—Ä—É–µ–º –º–µ–ª–∫–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
    if (swipeDistance < 0) {
      showNext(); // —Å–≤–∞–π–ø –≤–ª–µ–≤–æ ‚Üí —Å–ª–µ–¥—É—é—â–µ–µ
    } else {
      showPrev(); // —Å–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ ‚Üí –ø—Ä–µ–¥—ã–¥—É—â–µ–µ
    }
  }
</script>

</section>

{% endblock %}

{% block scripts %}
{{ super() }}
{% endblock %}