{% extends "base.html" %}

{% block title %}–î–æ–º "–°–æ–ª–Ω–µ—á–Ω—ã–π" - –ö—Ä–µ–ø–∫–∏–π –§—É–Ω–¥–∞–º–µ–Ω—Ç{% endblock %}

{% block hero %} {% endblock %}

{% block features %} {% endblock %}

{% block content %}

<!-- üîπ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ -->
<section class="py-5">
  <div class="container">
    <div class="row g-4 align-items-start">

      <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç -->
      <div class="col-lg-8">
        <h1 class="fw-bold mb-3" style="font-family: 'Oswald', sans-serif;">{{ house.title }}</h1>
        <p class="text-secondary fs-6 mb-4">
            {{ house.description }}
        </p>

        <h5 class="fw-semibold mt-4 mb-3">–ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å:</h5>
        <ul class="text-secondary">
          <li>–ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞—è —á–∏—Å—Ç–æ–≤–∞—è –æ—Ç–¥–µ–ª–∫–∞;</li>
          <li>–¢—ë–ø–ª—ã–µ –ø–æ–ª—ã –ø–æ –≤—Å–µ–º—É –¥–æ–º—É;</li>
          <li>–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞ –ø–æ–¥ –∫–ª—é—á;</li>
          <li>–û—Ç–¥–µ–ª–∫–∞ —Å–∞–Ω—É–∑–ª–∞ –∏ –∫–æ—Ç–µ–ª—å–Ω–æ–π;</li>
          <li>–í—Å–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏.</li>
        </ul>


        <div class="mt-4">
          <a href="tel:+79173755545" class="btn btn-primary btn-lg">
            üìû –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
          </a>
        </div>
      </div>

      <!-- –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
      <div class="col-lg-4">
        <div class="card border-0 shadow-sm p-4">
          <h5 class="fw-bold mb-3" style="font-family: 'Oswald', sans-serif;">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h5>
          <table class="table table-borderless text-secondary small mb-0">
            <tbody>
                <tr>
                    <th scope="row">–ü–ª–æ—â–∞–¥—å:</th>
                    <td>{{ house.square }} –º¬≤</td>
                </tr>
                <tr>
                    <th scope="row">–†–∞–π–æ–Ω:</th>
                    <td>{{ house.area }}</td>
                </tr>
                <tr>
                    <th scope="row">–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞:</th>
                    <td>{{ house.price_base | money }} ‚ÇΩ</td>
                </tr>
                <tr>
                    <th scope="row">–° –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º–∏:</th>
                    <td>{{ house.price_with_communications | money }} ‚ÇΩ</td>
                </tr>
                <tr>
                    <th scope="row">–¶–µ–Ω–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –¥–æ–º–∞:</th>
                    <td>{{ house.price_ready | money }} ‚ÇΩ</td>
                </tr>
                <tr>
                    <th scope="row">–ò–ø–æ—Ç–µ–∫–∞ (–≤ –º–µ—Å—è—Ü):</th>
                    <td>{{ house.mortgage_price_per_month | money }} ‚ÇΩ</td>
                </tr>
            </tbody>


          </table>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- üîπ –ì–∞–ª–µ—Ä–µ—è –ø—Ä–æ–µ–∫—Ç–∞ -->
<section class="py-4 bg-light">
  <div class="container">
    <div class="gallery-wrapper text-center">

      <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
      <div class="main-image mb-3 position-relative">
        <img 
          id="mainImage" 
          src="{{ url_for('static', filename='house_project_1/1.jpg') }}" 
          class="img-fluid rounded shadow-sm"
          alt="–û—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞"
          style="cursor: zoom-in;"
          data-bs-toggle="modal"
          data-bs-target="#imageModal"
        >
      </div>

      <!-- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã -->
      <div class="thumbnail-list d-flex justify-content-center flex-wrap gap-2">
        <img src="{{ url_for('static', filename='house_project_1/1.jpg') }}" class="thumb-img active" alt="–í–∏–¥ 1" onclick="changeImage(this)">
        <img src="{{ url_for('static', filename='house_project_1/2.webp') }}" class="thumb-img" alt="–í–∏–¥ 2" onclick="changeImage(this)">
        <img src="{{ url_for('static', filename='house_project_1/3.webp') }}" class="thumb-img" alt="–í–∏–¥ 3" onclick="changeImage(this)">
        <img src="{{ url_for('static', filename='house_project_1/4.webp') }}" class="thumb-img" alt="–í–∏–¥ 4" onclick="changeImage(this)">
      </div>
    </div>
  </div>
</section>

<!-- üîπ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content bg-dark border-0">
      <div class="modal-body p-0 position-relative d-flex justify-content-center align-items-center">

        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è -->
        <button 
          type="button" 
          class="btn-close btn-close-white position-absolute top-0 end-0 m-3"
          data-bs-dismiss="modal" 
          aria-label="–ó–∞–∫—Ä—ã—Ç—å"
          style="z-index: 1056; filter: drop-shadow(0 0 3px black);"
        ></button>

        <!-- –°–ª–∞–π–¥–µ—Ä -->
        <div id="modalCarousel" class="carousel slide w-100 h-100" data-bs-ride="false">
          <div class="carousel-inner" id="modalCarouselInner">
            <!-- –°–ª–∞–π–¥—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JS -->
          </div>

          <!-- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
          <button 
            class="carousel-control-prev" 
            type="button" 
            data-bs-target="#modalCarousel" 
            data-bs-slide="prev"
            style="z-index: 1055;"
          >
            <span class="carousel-control-prev-icon"></span>
          </button>
          <button 
            class="carousel-control-next" 
            type="button" 
            data-bs-target="#modalCarousel" 
            data-bs-slide="next"
            style="z-index: 1055;"
          >
            <span class="carousel-control-next-icon"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  const mainImage = document.getElementById('mainImage');
  const thumbs = document.querySelectorAll('.thumb-img');
  const modalCarouselInner = document.getElementById('modalCarouselInner');

  // –°–º–µ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –±–ª–æ–∫–µ
  function changeImage(element) {
    mainImage.src = element.src;
    thumbs.forEach(img => img.classList.remove('active'));
    element.classList.add('active');
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–∞–π–¥–æ–≤
  const imageSources = Array.from(thumbs).map(img => img.src);
  modalCarouselInner.innerHTML = ''; // –æ—á–∏—â–∞–µ–º, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –∑–∞–Ω–æ–≤–æ
  imageSources.forEach((src, index) => {
    const div = document.createElement('div');
    div.classList.add('carousel-item');
    if (index === 0) div.classList.add('active');
    div.innerHTML = `
      <div class="d-flex justify-content-center align-items-center" style="height:100vh;">
        <img src="${src}" class="d-block modal-img" alt="–§–æ—Ç–æ ${index + 1}">
      </div>`;
    modalCarouselInner.appendChild(div);
  });

  // –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ª–∞–π–¥
  mainImage.addEventListener('click', () => {
    const carousel = bootstrap.Carousel.getOrCreateInstance('#modalCarousel');
    const currentIndex = imageSources.indexOf(mainImage.src);
    carousel.to(currentIndex);
  });
</script>
{% endblock %}